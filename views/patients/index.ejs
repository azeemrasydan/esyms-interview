<%- include ('../partials/navbar-staff') %>

    <div class="card" style="padding-left: 5px;">
        <h1 class="mt-4">Your Patient Lists</h1>
        <p class="lead mb-3">Welcome <%= name %>, Clinic <%= unit %> personnel
        </p>
        <a href="/patients/create" class="btn btn-secondary"
            style="margin:5px 5px 5px 5px; width:300px; float:right">Add New Patient<i class="fas fa-user-plus"
                style="margin-left:5px"></i></a>

        <%- include ("../messages") %>
            <div class="accordion" id="accordionExample">

                <% patients.forEach(function(patient){ %>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="heading<%= patient._id %> ">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapse<%= patient._id %>" aria-expanded="false"
                                aria-controls="<%= patient._id %>">
                                <strong>
                                    <%= patient.mrn %> : <%= patient.firstName %>
                                            <%= patient.lastName %>
                                </strong>
                            </button>


                        </h2>
                        <div id="collapse<%= patient._id %>" class="accordion-collapse collapse"
                            aria-labelledby="heading<%= patient._id %>" data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                <div class="row mt-3">
                                    <div class="col-md-8 m-auto">

                                        <div class="card card-body text-center">
                                            <form action="/patients/delete/<%=patient._id %>" method="POST">
                                                <button type="submit" class="btn btn-danger"
                                                    style="margin:5px 5px 5px 5px; width:60px;float:left;overflow:hidden"><i
                                                        class="fas fa-trash-alt" style="margin-right:5px"></i></button>
                                            </form>
                                            <form action="/patients/addresses/create/<%=patient._id %>" method="GET">
                                                <button type="submit" class="btn btn-primary"
                                                    style="margin:5px 5px 5px 5px; width:60px;float:right; overflow:hidden;position: relative;"><i
                                                        class="fas fa-address-book"
                                                        style="margin-right:5px"></i></button>
                                            </form>
                                            <form action="/patients/nextofkin/create/<%=patient._id %>" method="GET">
                                                <button type="submit" class="btn btn-info"
                                                    style="margin:5px 5px 5px 5px; width:60px;float:right; overflow:hidden;position: relative;"><i
                                                        class="fas fa-user-friends" style="margin-right:5px"></i></button>
                                            </form>

                                            <h1 class="mb-3">
                                                <i class="fas fa-user-injured"></i>
                                            </h1>
                                            <h2>
                                                <%=patient.firstName %>'s Details
                                            </h2>

                                            <form action="/patients/<%=patient._id %>" method="POST">
                                                <div class="form-group">
                                                    <label for="mrn">Medical Record No</label>
                                                    <input type="text" id="mrn" name="mrn" class="form-control"
                                                        placeholder="PT0050225" required value=<%=patient.mrn %>
                                                    readonly />
                                                </div>
                                                <div class="form-group">
                                                    <label for="firstName">First Name</label>
                                                    <input type="text" id="firstName" name="firstName"
                                                        class="form-control" placeholder="Enter First Name" required
                                                        value=<%=patient.firstName %> />
                                                </div>
                                                <div class="form-group">
                                                    <label for="lastName">Last Name</label>
                                                    <input type="text" id="lastName" name="lastName"
                                                        class="form-control" placeholder="Enter Last Name" required
                                                        value=<%=patient.lastName %> />
                                                </div>
                                                <div class="form-group">
                                                    <label for="dob">Date of Birth</label>
                                                    <input type="date" id="dob" name="dob" class="form-control"
                                                        placeholder="Select Date of Birth" required value=<%=patient.dob
                                                        %> />
                                                </div>
                                                <div class="form-group">
                                                    <label for="gender">Gender</label>
                                                    <select class="form-select form-select-lg mb-3" name="gender"
                                                        id="gender" aria-label=".form-select-lg example">
                                                        <% if(patient.gender=="M" ){ %>
                                                            <option value="M" selected>Male</option>
                                                            <option value="F">Female</option>
                                                            <% }else{ %>
                                                                <option value="M">Male</option>
                                                                <option value="F" selected>Female</option>
                                                                <% } %>
                                                    </select>
                                                </div>
                                                <div class="form-group">
                                                    <label for="contactNo">Contact No</label>
                                                    <input type="tel" id="contactNo" name="contactNo"
                                                        class="form-control" placeholder="019-9869507" required
                                                        value=<%=patient.contactNo %> />
                                                </div>
                                                <div class="form-group">
                                                    <label for="email">Email</label>
                                                    <input type="email" id="email" name="email" class="form-control"
                                                        placeholder="Enter Email" required value=<%=patient.email %> />
                                                </div>

                                                <button type="submit" class="btn btn-primary btn-block">Update</button>
                                            </form>
                                            <form action="/patients">
                                                <button type="submit" class="btn btn-warning btn-block"
                                                    style="margin-top: 15px">Cancel</button>
                                            </form>
                                            
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                    <% }); %>

            </div>
    </div>